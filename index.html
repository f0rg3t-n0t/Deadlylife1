<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Chapter 1-DEADLY LIFE</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet"/>
  <style>

    body {
      font-family: 'Noto Sans KR', sans-serif;
      background-color: #ececeb;
      color: black;
      text-align: center;
      padding: 2em;
    }
    .hidden { display: none; }

#user-display {
  position: fixed;
  top: 10px;
  left: 10px;
  z-index: 9999;
  display: flex;
  align-items: center;
  background-color: #ececeb;
  padding: 8px 12px;
  border-radius: 8px;
  box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.15);
  font-family: monospace;
  color: #202e70;
  border: 1px solid #ddd;
  min-width: 180px;
}

#persistent-nav {
  position: fixed;
  top: 110px;
  left: 10px;
  z-index: 9999;
  display: none;
  flex-direction: column;
  gap: 4px; /* 버튼 사이 간격 줄임 */
  background-color: #ececeb;
  padding: 6px 8px; /* 네모 자체 여백 줄임 */
  border-radius: 6px;
  box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.15);
  border: 1px solid #ddd;
  min-width: 140px; /* 폭도 작게 */
}

#persistent-nav button {
  background-color: #202e70;
  color: white;
  border: none;
  border-radius: 4px;
  padding: 4px 6px;     /* 버튼 내부 여백 줄임 */
  margin: 0;            /* 버튼 외부 여백 제거 */
  cursor: pointer;
  font-family: inherit;
  font-size: 12px;      /* 글자 크기 줄임 */
  transition: background-color 0.2s ease;
}

#persistent-nav button:hover {
  background-color: #0b1029;
}

#barcode-icon {
  width: 60px;
  height: 40px;
  margin-right: 10px;
}

#user-text > div {
  font-size: 14px;
  line-height: 1.4;
  color: #202e70;  /* 혹시 상속이 안 될 수도 있으니 명시 */
}
    #bgm-player {
      position: fixed;
      top: 10px;
      right: 10px;
      background: rgba(255, 255, 255, 0.8);
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    #bgm-player button {
      background-color: #202e70 !important;
      color: white;
    }

    .fade-in {
      animation: fadein 1.2s ease-in;
            }
  
    @keyframes fadein {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .typewriter {
      font-weight: bold;
      font-size: 1.1em;
      white-space: nowrap;
      overflow: hidden;
      border-right: 2px solid #202e70;
      width: 0;
      animation: typing 3s steps(30, end) forwards, blink 0.75s step-end infinite;
      margin-bottom: 1em;
    }

    @keyframes typing {
      from { width: 0; }
      to { width: 100%; }
    }

    @keyframes blink {
      50% { border-color: transparent; }
    }

    @keyframes pop {
    0% { transform: scale(0.7); opacity: 0; }
    60% { transform: scale(1.1); opacity: 1; }
    100% { transform: scale(1); }
  }

  #drink-result {
    animation: pop 0.6s ease-out;
    transition: all 0.2s ease;
  }
  
    button {
      font-size: 1em;
      padding: 10px 20px;
      margin: 10px;
      border: none;
      background-color: #202e70;
      color: white;
      border-radius: 10px;
      cursor: pointer;
    }
    button:hover {
      background-color: #0b1029;
    }
    .nav-button {
      background-color: #444 !important;
      font-size: 0.85em !important;
      padding: 5px 12px !important;
    }
    .logo {
      width: 200px;
      margin-bottom: 1em;
    }
  </style>
</head>

<!-- !!!!여기서부터 BODY!!!! -->
<body>
  <!-- 유저 디스플레이 -->
<div id="user-display">
  <img src="zzapbarcode.png" alt="barcode" id="barcode-icon">
  <div id="user-text">
    <p id="user-class-line">User ID : UNKNOWN</p>
  </div>
</div>
  <!-- 브금 플레이어 -->
  <div id="bgm-player">
    <audio id="bgm" src="zzapbgm.mp3" loop></audio>
    <button onclick="document.getElementById('bgm').play()">▶</button>
    <button onclick="document.getElementById('bgm').pause()">⏸</button>
  </div>
  
  <!-- 로고 -->
  <img class="logo" src="zzaplogo.png"/>
  
  <!-- 내비게이션 -->
  <div id="persistent-nav">
  <button onclick="goTo('main-page-2nd')">메인 화면</button>
  <button onclick="goTo('guide')">조사 가이드</button>
  <button onclick="goTo('starting-point')">건물 입구로</button>
</div>
  
<!-- main-page 버튼 이미지 배치 -->
<div id="main-page" class="hidden" style="position: relative; height: 100vh; background-color: #ececeb;">
  <!-- Initiation -->
  <img src="initiation.png" class="menu-button initiation" loading="lazy" onclick="goTo('starting-point')" alt="시작">
  <!-- Guide -->
  <img src="guide.png" class="menu-button guide" loading="lazy" onclick="goTo('guide')" alt="가이드">
  <!-- Report -->
  <img src="report.png" class="menu-button report" loading="lazy" onclick="goTo('report')" alt="종료">
</div>
<style>
  .menu-button {
    position: absolute;
    cursor: pointer;
    transform-style: preserve-3d;
    transform: translateX(0) scale(1); /* 애니메이션 최종 위치 */
    transition: transform 0.4s ease;
    opacity: 0;
    pointer-events: none; /* 애니메이션 끝날 때까지 hover 방지 */
  }
  /* Initiation 버튼 */
  .initiation {
    top: 1%;
    left: 39%;
    width: 12%;
    height: auto;
    animation-name: slideInLeft;
    animation-duration: 1.2s;
    animation-delay: 0.2s;
    animation-fill-mode: forwards;
    animation-timing-function: ease-out;
  }
  /* Guide 버튼 */
  .guide {
    top: 17%;
    right: 40%;
    width: 14%;
    height: auto;
    animation-name: slideInRight;
    animation-duration: 1.2s;
    animation-delay: 0.3s;
    animation-fill-mode: forwards;
    animation-timing-function: ease-out;
  }

  /* Report 버튼 */
  .report {
    top: 36%;
    left: 39%;
    width: 15%;
    height: auto;
    animation-name: slideInLeft;
    animation-duration: 1.2s;
    animation-delay: 0.4s;
    animation-fill-mode: forwards;
    animation-timing-function: ease-out;
  }

  /* 등장 애니메이션 정의 */
  @keyframes slideInLeft {
    0% {
      transform: translateX(-80%) scale(0.9);
      opacity: 0;
    }
    100% {
      transform: translateX(0) scale(1);
      opacity: 1;
    }
  }

  @keyframes slideInRight {
    0% {
      transform: translateX(80%) scale(0.9);
      opacity: 0;
    }
    100% {
      transform: translateX(0) scale(1);
      opacity: 1;
    }
  }
/* 공통 Hover 발광 효과 */
.initiation:hover,
.guide:hover,
.report:hover {
  filter: drop-shadow(0 0 8px rgba(32, 46, 112, 0.6)); /* #202e70 계열 빛 */
  transition: filter 0.4s ease-in-out;
}

</style>

<!-- !!!!여기서부터 작동시킬 페이지들!!!! -->
  <!-- 로그인 화면 -->
  <div id="login-page">
    <p>ID를 입력하세요.</p>
    <input id="id-input" type="text" />
    <button onclick="checkLogin()">확인</button>
    <p id="login-error" style="color: #ff4444;"></p>
  </div>

    <!-- guide 페이지 -->
<div id="guide" class="hidden" style="padding: 3em; text-align: left; text-align: left; max-width: 700px; margin: 0 auto; background: white; border: 3px solid #202e70; border-radius: 10px; color: black;">
  <p><span style="font-weight: bold; color: #202e70;">조사 가이드</span><br><br><br>
    웹에서는 클릭, 모바일에서는 터치로 진행합니다. 자유롭게 종료하고 재실행하셔도 좋지만, 창을 닫거나 뒤로가기/새로고침할 시 진행 경과가 초기화되니 주의해 주세요.<br>
    본 조사는 별도의 서버를 사용하지 않기 때문에 세션을 종료하면 결과가 저장되지 않습니다.<br><br>
    메인 화면에서 '조사 종료→조사 마치기' 를 클릭하면 획득한 증거를 정리해 주는 화면이 표시됩니다. 최종 화면을 표시한 후에는 이전으로 돌아갈 수 없습니다.<br>
    최종 화면은 별도의 제출을 필요로 하지 않습니다. 스크린샷 등을 통해 각자 보관해 주세요.</p>
    <br>
    <button class="nav-button" onclick="goBack()">나가기</button>
</div>

  <!-- 레포트 주의사항 -->
  <div id="report" class="hidden">
    <p>모든 조사를 마치고 최종 리포트를 작성하여 획득한 증거를 정리합니다. 진행할 시 이전 단계로 되돌아갈 수 없습니다.<br>조사를 마칠까요?</p>
    <button onclick="loadFinalReport()">조사를 마친다</button><br>
    <button class="nav-button" onclick="goBack()">취소</button>
  </div>
  
  <!-- 뒤로가기 적용된 메인 페이지 -->
<div id="main-page-2nd" class="hidden" style="position: relative; height: 100vh; background-color: #ececeb;">
  <!-- Initiation -->
  <img src="initiation.png" class="menu-button initiation" onclick="goBack()" alt="시작">
  <!-- Guide -->
  <img src="guide.png" class="menu-button guide" onclick="goTo('guide')" alt="가이드">
  <!-- Report -->
  <img src="report.png" class="menu-button report" onclick="goTo('report')" alt="종료">
  </div>
  
  <!-- 스타팅 포인트 -->  
  <div id="starting-point" class="hidden">
    <p><span style="font-weight: bold;">[건물 입구]</span><br><br>흰 관을 연상시키는 건물. 그 입구에 다다른다.<br>돌로 된 정문 표면에는 알 수 없는 문자가 빼곡히 음각으로 새겨져 있다. 무엇을 기록한 것인지는 알 수 없으나, 음산하고 기분 나쁜 분위기가 풍긴다.<br>이 입구를 기점 삼아 건물 안으로 들어가거나, 섬의 시설물을 둘러보고 돌아올 수 있을 것 같다.</p>
    <button onclick="goTo('inside')">건물 안으로 들어간다</button>
    <button onclick="goTo('outside')">건물 밖으로 나간다</button>
  </div>

  <!-- 내부 1층 --> 
  <div id="inside" class="hidden">
    <p><span style="font-weight: bold;">[건물 1층]</span><br><br>건물 1층.<br>정면에 방문객을 맞이하는 <span style="color: #202e70;">로비</span>가 보이고, 로비 뒤편에는 뒤편에는 유리로 된 <span style="color: #202e70;">엘리베이터</span>가 배치되어 있다.<br>더 안쪽에 있는 복도는 <span style="color: #202e70;">레스토랑</span>으로 이어지는 듯하다.</p>
    <button onclick="goTo('lobby')">로비</button>
    <button onclick="goTo('elevator')">엘리베이터</button>
    <button onclick="goTo('restaurant')">레스토랑</button><br>
    <button class="nav-button" onclick="goTo('starting-point')">건물 입구로 돌아가기</button>
  </div>

    <!-- 로비 --> 
    <div id="lobby" class="hidden">
    <p><span style="font-weight: bold;">[로비]</span><br><br>건물에 들어오면 가장 먼저 보게 되는 곳.<br>무채색의 석조 <span style="color: #202e70;">카운터</span>를 중심으로 내빈을 위한 <span style="color: #202e70;">라운지</span>가 마련되어 있다.</p>
    <button onclick="goTo('counter')">카운터</button>
    <button onclick="goTo('waitingspace')">라운지</button><br>
    <button class="nav-button" onclick="goTo('inside')">나가기</button>
  </div>

    <!-- 로비:카운터 --> 
    <div id="counter" class="hidden">
    <p><span style="font-weight: bold;">[로비]<br>[카운터]</span><br><br>보통이라면 직원이 서 있어야 할 카운터 너머에는 아무도 없다.<br>조명이 몇 개 꺼져 어둑하고, 공증인의 목소리조차 들리지 않는다.<br>혼자만의 힘으로 조사해 보라는 뜻일까...</p>
    <button class="nav-button" onclick="goTo('lobby')">나가기</button>
 </div>

    <!-- 로비:라운지 --> 
    <div id="waitingspace" class="hidden">
    <p><span style="font-weight: bold;">[로비]<br>[라운지]</span><br><br>카운터 앞쪽에 배치된 라운지. 잠시 쉬어가는 용도의 소파가 배치되어 있지만 지금은 적당한 때가 아니다.<br>라운지 양쪽으로는 큰 유리창이 나 있어 섬의 풍경이 한눈에 들어온다.<br>사방을 둘러싼 바다는 우리가 더는 이 섬에서 나갈 수 없다는 사실을 상기시킨다.<br>라운지 중앙에는 작은 <span style="color: #202e70;">책꽂이</span>가 설치되어 있다. </p>
    <button onclick="goTo('bookshelf')">책꽂이</button><br>
    <button class="nav-button" onclick="goTo('lobby')">나가기</button>
 </div>
    <!-- 로비:라운지:책꽂이 --> 
    <div id="bookshelf" class="hidden">
    <p><span style="font-weight: bold;">[로비]/[라운지]<br>[책꽂이]</span><br><br>
    책의 종류는 전에 본 미래기관이나 초세계급에 대한 책자가 대부분이다.<br>또, 로렘의 유언을 기록한 얇은 책 하나도 함께 꽂혀 있다.</p>
    <button onclick="goToWithSound('book2','zzapbook.mp3')">《궁금해요! 초세계급 A to Z》</button><br>
    <button onclick="goToWithSound('book1','zzapbook.mp3')">《초세계급 기록자 로렘의 유언》</button><br>
    <button class="nav-button" onclick="goTo('waitingspace')">나가기</button>
 </div>

    <!-- 로비:라운지:책1 --> 
    <div id="book1" class="hidden">
    <p><span style="font-weight: bold;">[로비]/[라운지]<br>[책꽂이]</span><br><br>
    검은 표지의 책.<br><br>
…유언의 집행자는 섬에서 체류하며 하기의 항목을 이행한다.<br><br>1-1. 타 유언 집행자를 대상으로 한 의도적, 계획적 살해 및 증거의 은폐.<br><br>1-2. 전항으로 말미암아 발생한 살해 사건에 대한 조사.<br><br>……</p>
    <button class="nav-button" onclick="goTo('bookshelf')">나가기</button>
 </div>

      <!-- 로비:라운지:책2 --> 
    <div id="book2" class="hidden">
    <p><span style="font-weight: bold;">[로비]/[라운지]<br>[책꽂이]</span><br><br>
    푸른색 표지의 책. 새로 인쇄했는지 종이가 빳빳하다<br><br>초세계급으로 선발된 인원들에 대한 소개 중에서 에르네스토의 이야기도 찾을 수 있다.<br><br>
    1991년 출생.<br>2005년 재해로 인해 실향.<br>2022년 초세계급 재해과학자로 임명.<br><span style="font-weight: bold;">2025년 사망.</span>
</p>
    <button class="nav-button" onclick="goTo('bookshelf')">나가기</button>
 </div>

    <!-- 로비:엘리베이터 --> 
    <div id="elevator" class="hidden">
    <p><span style="font-weight: bold;">[엘리베이터]</span><br><br>유리로 되어 있어 내부가 전부 들여다보이는 엘리베이터.<br>이 건물은 엘리베이터 주변의 공간이 뻥 뚫린 구조로 설계되어 있다.<br>몇 층까지 있는지, 어떤 위험한 시설이 존재하는지조차 우리는 모른다...</p>
    <button onclick="goTo('elevator1')">탑승한다</button><br>
    <button class="nav-button" onclick="goTo('inside')">나가기</button>
 </div>      
  
      <!-- 로비:엘리베이터:탑승 --> 
    <div id="elevator1" class="hidden">
    <p><span style="font-weight: bold;">[엘리베이터]</span><br><br>원하는 층으로 이동할 수 있다.<br>3층 이상부터는 정비 중인지, 버튼을 눌러도 불이 들어오지 않는다.</p>
    <button onclick="goToWithSound('inside','zzapelevator.mp3')">1층</button><br>
    <button onclick="goToWithSound('2ndfloor','zzapelevator.mp3')">2층</button><br>
 </div>     
  
    <!-- 레스토랑 --> 
    <div id="restaurant" class="hidden">
    <p><span style="font-weight: bold;">[레스토랑]</span><br><br>평소 즐거운 대화 소리가 오가던 레스토랑은 쥐 죽은 듯이 조용하다.
    </p>
      <button class="nav-button" onclick="goTo('inside')">나가기</button>
  </div>

    <!-- 2층 --> 
    <div id="2ndfloor" class="hidden">
    <p><span style="font-weight: bold;">[2층]</span><br><br>왼쪽 복도는 <span style="color: #202e70;">내빈용 객실</span>로, 오른쪽 복도는 <span style="color: #202e70;">회의실</span>로 이어진다. 1층으로 돌아갈 때는 엘리베이터를 이용하자.</p>
    <button onclick="goTo('elevator1')">엘리베이터</button><br>
    <button onclick="goTo('suite')">내빈용 객실</button>
    <button onclick="goTo('office')">회의실</button><br>
 </div>     
  
    <!-- 내빈용 객실 --> 
    <div id="suite" class="hidden">
    <p><span style="font-weight: bold;">[내빈용 객실]</span><br><br>초세계급들을 위한 개인실.<br>문 앞에 붙은 명패에는 각자의 이름과 재능이 쓰여 있다.<br>객실이 이어지는 복도 끝에는 '<span style="color: #202e70;">비품실</span>'이라고 표시된 작은 방이 보인다.</p>
    <button onclick="goTo('suite1')">개인실을 조사한다</button>
    <button onclick="goTo('bipum')">비품실</button><br>
    <button class="nav-button" onclick="goTo('2ndfloor')">나가기</button>
  </div>

     <!-- 내빈용 객실 --> 
    <div id="suite1" class="hidden">
    <p><span style="font-weight: bold;">[내빈용 객실]/[개인실]</span><br><br>누구의 개인실을 조사할까? 정확한 풀네임으로 입력하자.</p>
<input type="text" id="secret-code-input">
<p id="secret-code-result"></p>
<button id="secret-code-button" onclick="checkSecretCode()">확인</button><br>
    <button class="nav-button" onclick="goTo('suite')">나가기</button>
 </div>

  
    <!-- 에른 방 --> 
    <div id="evi13" class="hidden">
    <p><span style="font-weight: bold;">[내빈용 객실]/[에르네스토의 개인실]</span>
    <br><br>모두에게 제공되는 것과 크게 다르지 않은 에르네스토의 방.<br>방 주인의 성격을 반영하듯 대충대충 정리된 것이 눈에 띈다. 개지도 않은 이불이라거나...<br><br>특별히 눈에 띄는 것은 없지만, 모든 객실에 비치해 두는 메모장이 보이지 않는다.</p>
    <button class="nav-button" onclick="goTo('suite')">나가기</button>
  </div>

    <!-- 비품실 --> 
    <div id="bipum" class="hidden">
    <p><span style="font-weight: bold;">[내빈용 객실]/[비품실]</span><br><br>생활에 필요한 각종 비품을 구비해 두는 곳.<br>휴지나 종이컵 같은 일회용품부터 각종 청소용구까지, 없는 게 없다.<br>비품실 한가운데에 커다란 <span style="color: #202e70;">도구함</span>이 뚜껑이 닫힌 채로 놓여 있다.</p>
    <button onclick="goTo('evi14')">도구함을 연다</button><br>
    <button class="nav-button" onclick="goTo('suite')">나가기</button>
  </div>
  
      <!-- 비품실 : 도구함 --> 
    <div id="evi14" class="hidden">
    <p><span style="font-weight: bold;">[내빈용 객실]/[비품실]</span><br><br>도구함의 뚜껑을 들어올리면, 그 안에는 톱, 전동 가위, 도끼 같은 물건들이 가지런히 들어 있다.<br><br>무언가 사라진 것 같지는 않다. 아무도 건드리지 않은 모양이다.</p>
    <button class="nav-button" onclick="goTo('bipum')">나가기</button>
  </div>
  
    <!-- 회의실 --> 
    <div id="office" class="hidden">
    <p><span style="font-weight: bold;">[회의실]</span><br><br>세미나 등을 진행할 수 있는 회의실. 사무실의 역할도 겸하고 있다.<span style="color: #202e70;">사무용 책상</span>과 그 위의 <span style="color: #202e70;">컴퓨터</span>가 눈에 띈다.</p>
    <button onclick="goTo('pcdesk')">사무용 책상</button>
    <button onclick="goTo('computer')">컴퓨터</button><br>   
    <button class="nav-button" onclick="goTo('2ndfloor')">나가기</button>
  </div>

    <!-- 회의실 : 사무용 책상 --> 
    <div id="pcdesk" class="hidden">
    <p><span style="font-weight: bold;">[회의실]/[사무용 책상]</span><br><br>책상 위에는 고급스러운 펜과 메모장이 놓여 있다.<br>책상 아래에는 서랍이 달려 있다.</p>
    <button onclick="goTo('pcdesk1')">서랍을 연다</button><br>
    <button class="nav-button" onclick="goTo('office')">나가기</button>
  </div>
  
      <!-- 회의실 : 사무용 책상 : 서랍--> 
    <div id="pcdesk1" class="hidden">
    <p><span style="font-weight: bold;">[회의실]/[사무용 책상]</span><br><br>서랍 안에는 각종 비품과 더불어 구급상자가 하나 놓여 있다.<br>열어 보면 웬만한 응급처치는 가능할 정도로 다양한 용품이 들어 있다.<br>그러나 손댄 흔적은 없다. 이 물건들이 쓸모를 다할 기회는 찾아오지 않았다.</p>
    <button class="nav-button" onclick="goTo('office')">나가기</button>
  </div>

      <!-- 회의실 : 컴퓨터 --> 
    <div id="computer" class="hidden">
    <p><span style="font-weight: bold;">[회의실]/[컴퓨터]</span><br><br>컴퓨터에는 화상 통화 어플리케이션과 문서 편집 프로그램이 설치되어 있으나, 통화 어플리케이션은 작동하지 않는다.<br>인터넷이 차단되어 바깥 소식은 접할 수 없다.</p>
    <button class="nav-button" onclick="goTo('office')">나가기</button>
  </div>

  
    <!-- 바깥 1층 --> 
    <div id="outside" class="hidden">
    <p><span style="font-weight: bold;">[건물 바깥]</span><br><br>소금기 섞인 바람이 저편에서부터 불어온다. 비릿한 소금 냄새에 속이 울렁거린다.<br>건물에서 나가는 길을 따라가면 폭파로 인해 완전히 망가진 <span style="color: #202e70;">항구</span>로 이어진다.<br>항구에서 조금 떨어진 곳에 <span style="color: #202e70;">메모리얼 파크</span>가 위치해 있고, 묘지에서 섬 뒤편으로 이어지는 <span style="color: #202e70;">산책로</span>가 희미하게 보인다.</p>
    <button onclick="goToWithSound('port', 'zzapwalk_seaside.wav')">항구</button>
    <button onclick="goToWithSound('memorial', 'zzapwalk_seaside.wav')">메모리얼 파크</button>
    <button onclick="goToWithSound('street', 'zzapwalk_seaside.wav')">산책로</button><br>
    <button class="nav-button" onclick="goTo('starting-point')">건물 입구로 돌아가기</button>
  </div>

    <!-- 항구 --> 
    <div id="port" class="hidden">
        <p><span style="font-weight: bold;">[항구]</span><br><br>작은 규모의 항구에는 이곳으로 올 때 탔던 배가 폭파로 인해 부서진 잔해만이 나뒹군다.<br>이 섬에서 나갈 방법은 무엇 하나 존재하지 않는다. 우리는 고립되었다.</p>
    <button class="nav-button" onclick="goTo('outside')">나가기</button>
  </div>
  
    <!-- 메모리얼 파크 --> 
    <div id="memorial" class="hidden">
    <p><span style="font-weight: bold;">[메모리얼 파크 입구]</span><br><br>흰 울타리로 둘러싸여 구획지어진 공간이 바다와 접하고 있다.<br>한밤의 메모리얼 파크는 을씨년스럽기 그지없다.<br><br>
    <button onclick="goTo('memorial1')">메모리얼 파크에 입장한다</button><br>
    <button class="nav-button" onclick="goTo('outside')">나가기</button>
  </div>

      <!-- 메모리얼 파크:1 --> 
    <div id="memorial1" class="hidden">
    <p><span style="font-weight: bold;">[메모리얼 파크]</span><br><br>짧게 깎인 잔디 위로 새하얀 비석이 놓였다.<br>이곳은 세상을 떠난 초세계급을 기리는 메모리얼 파크. 당장이라도 죽음이 발목을 붙잡을 것만 같다.<br>불규칙한 파도 소리가 마치 비웃음처럼 들린다.<br>메모리얼 파크를 가로지르는 길은 <span style="color: #202e70;">화원</span>으로 이어진다.<br><br>로렘의 묘비 옆에는 어제까지만 해도 없었던 <span style="color: #202e70;">의문의 무덤</span>이 있다. </p>
    <button onclick="goTo('memorial-lorem')">로렘의 묘비</button>
    <button onclick="goTo('memorial-ern')">의문의 무덤</button>
    <button onclick="goTo('garden')">화원</button><br>
    <button class="nav-button" onclick="goToWithoutzzapsea('memorial')">나가기</button>
  </div>

      <!-- !!메모리얼 파크:화원 --> 
    <div id="garden" class="hidden">
    <p><span style="font-weight: bold;">[메모리얼 파크]<br>[화원]</span><br><br>화원. 장미 덤불이 시야를 가릴 정도의 높이로 다듬어져 있어 마치 미로를 연상케 한다.<br>한켠에는 <span style="color: #202e70;">헌화용 꽃</span>이 놓여 있던 공간이 있다.<br>꽃이 놓인 공간 근처에 화원 관리에 필요한 물건들을 둔 <span style="color: #202e70;">도구 상자</span>가 보인다.</p>
    <button onclick="goTo('nfl')">헌화용 꽃을 확인한다</button>
    <button onclick="goTo('evi7')">화원의 도구 상자</button><br>
    <button class="nav-button" onclick="goTo('memorial1')">나가기</button>
  </div>

        <!-- !!헌화용 꽃 --> 
    <div id="nfl" class="hidden">
    <p><span style="font-weight: bold;">[메모리얼 파크]/[화원]/[헌화용 꽃]</span><br><br>본래 가득 쌓여 있었던 헌화용 꽃이 무더기로 사라져 있다.<br>국화는 거의 사라지고 수국과 장미만 남았다.</p>
    <button class="nav-button" onclick="goTo('garden')">나가기</button>
  </div>
  
    <!-- !!도구상자 --> 
    <div id="evi7" class="hidden">
    <p><span style="font-weight: bold;">[메모리얼 파크]/[화원]/[도구 상자]</span><br><br>메모리얼 파크와 화원을 관리할 수 있는 도구 몇 가지가 간단하게 정리되어 있다.<br>다만 무덤을 만들고 관리하기 위한 도구들은 사용한 흔적이 없다.<br>오히려 엉뚱하게 화원에 물을 주기 위한 고무호스나 물 양동이 따위만 누가 쓰고 돌려놓은 것 같다.</p>
    <button class="nav-button" onclick="goTo('garden')">나가기</button>
  </div>

      <!-- !!메모리얼 파크:로렘의 묘비 --> 
    <div id="memorial-lorem" class="hidden">
    <p><span style="font-weight: bold;">[메모리얼 파크]<br>[로렘의 묘비]</span><br><br>1985.06.09-2025.XX.XX
    <br><br>로렘이 이 자리의 초세계급에게 서로를 살해하라는 유언을 남겼다는 것은 진실일까?<br>만일 진실이라면, 어째서?<br><br>물론 답은 들려올 리 없다.</p>
    <button class="nav-button" onclick="goTo('memorial1')">나가기</button>
  </div>

      <!-- !!메모리얼 파크:에르네스토 무덤 --> 
    <div id="memorial-ern" class="hidden">
    <p><span style="font-weight: bold;">[메모리얼 파크]<br>[의문의 무덤]</span><br><br>
    나름대로 정돈한 듯 가지런한 자세로 에르네스토 프로켈의 시체가 누워 있다.</p>
    <button onclick="goTo('evi1')">전체적인 상태</button><br>
    <button onclick="goTo('evi3')">머리를 살펴본다</button><br>
    <button onclick="goTo('evi5')">상체를 살펴본다</button><br>
    <button onclick="goTo('foot')">하체를 살펴본다</button><br>
    <button class="nav-button" onclick="goTo('memorial1')">나가기</button>
  </div>

      <!-- !!메모리얼 파크:에르네스토 무덤 --> 
    <div id="evi1" class="hidden">
    <p><span style="font-weight: bold;">[메모리얼 파크]<br>[의문의 무덤]</span><br><br>
    관 없이 매장된 탓에 옷에 흙먼지가 묻어 있으나 뜯어지거나 해진 곳은 없다.<br>오히려 마치 예의라도 차린 듯 잘 정돈된 상태다.</p>
   <button id="e1" onclick="ev2('e1')">자세히 본다</button><br>
  <button class="nav-button" onclick="goTo('memorial-ern')">나가기</button>
    <p id="evi2-result"></p>
  </div>

      <!-- !!메모리얼 파크:에르네스토 무덤 --> 
    <div id="evi2" class="hidden">
    <p><span style="font-weight: bold;">[메모리얼 파크]<br>[의문의 무덤]</span><br><br>
    에르네스토는 작은 체구가 아니다.<br>살해하는 것까지는 어떻게든 한다고 쳐도 시체를 깨끗하게 묻어 주려면 상당한 힘이 필요할 것이다.</p>
  <button class="nav-button" onclick="goTo('memorial-ern')">나가기</button>
  </div>

        <!-- !!메모리얼 파크:에르네스토 무덤 --> 
    <div id="evi3" class="hidden">
    <p><span style="font-weight: bold;">[메모리얼 파크]<br>[의문의 무덤]</span><br><br>
    뒤통수가 강한 힘으로 가격당한 듯 다소 찌그러져 있다.<br>머리카락에는 피와 흙이 엉겨 붙어서 엉망이다.</p>
     <button id="e3" onclick="ev4('e3')">자세히 본다</button><br>
  <button class="nav-button" onclick="goTo('memorial-ern')">나가기</button>
      <p id="evi4-result"></p>
  </div>

        <!-- !!메모리얼 파크:에르네스토 무덤 --> 
    <div id="evi4" class="hidden">
    <p><span style="font-weight: bold;">[메모리얼 파크]<br>[의문의 무덤]</span><br><br>
    용기를 내어 머리의 상흔을 좀 더 자세히 확인했다.<br>형태로 보아 흉기는 타격 범위가 넓은 둔기로 보인다.</p>
  <button class="nav-button" onclick="goTo('memorial-ern')">나가기</button>
  </div>

        <!-- !!메모리얼 파크:에르네스토 무덤 --> 
    <div id="evi5" class="hidden">
    <p><span style="font-weight: bold;">[메모리얼 파크]<br>[의문의 무덤]</span><br><br>
    머리에서 흐른 피가 옷에도 묻어 있다.<br>가슴 위쪽으로는 국화꽃이 다발로 놓여 있다. 설마... 시체에 헌화한 건가?</p>
  <button class="nav-button" onclick="goTo('memorial-ern')">나가기</button>
  </div>

          <!-- !!메모리얼 파크:에르네스토 무덤 --> 
    <div id="foot" class="hidden">
    <p><span style="font-weight: bold;">[메모리얼 파크]<br>[의문의 무덤]</span><br><br>
    머리에서 흐른 피가 옷에도 묻어 있다.</p>
     <button id="ft" onclick="ev6('ft')">자세히 본다</button><br>
  <button class="nav-button" onclick="goTo('memorial-ern')">나가기</button>
      <p id="evi6-result"></p>
  </div>

        <!-- !!메모리얼 파크:에르네스토 무덤 --> 
    <div id="evi6" class="hidden">
    <p><span style="font-weight: bold;">[메모리얼 파크]<br>[의문의 무덤]</span><br><br>
    자세히 보니 신발 쪽에 풀잎 따위가 붙어 있다. 산책로에 있을 법한 잡초다.</p>
  <button class="nav-button" onclick="goTo('memorial-ern')">나가기</button>
  </div>

      <!-- 산책로 --> 
    <div id="street" class="hidden">
    <p><span style="font-weight: bold;">[산책로]</span><br><br>섬 뒤쪽을 돌아볼 수 있는 해안산책로. 왕복 30분 정도 소요된다는 안내가 적혀 있다.<br>산책로 입구에는 <span style="color: #202e70;">자전거 대여소</span>와 <span style="color: #202e70;">작은 벤치</span>가 보인다.</p>
    <button onclick="goTo('street1')">걸어서 산책하기</button><br>
    <button onclick="goTo('street2')">자전거 대여소</button><br>
    <button onclick="goTo('bench')">작은 벤치</button><br>
    <button class="nav-button" onclick="goTo('outside')">나가기</button>
  </div>
      <!-- 산책로 --> 
    <div id="street1" class="hidden">
    <p><span style="font-weight: bold;">[산책로]</span><br><br>천천히 걸어서 산책하기로 했다. 산책로 주변에 피어난 풀들이 싱싱하다.</p>
      <button id="st1" onclick="ev8('st1')">주변을 자세히 살펴본다</button><br>
      <button onclick="goTo('street2-2')">계속 걷는다</button><br>
      <button class="nav-button" onclick="goTo('street')">나가기</button>
      <p id="evi8-result"></p>
  </div>

        <!-- 산책로 --> 
      <div id="evi8" class="hidden">
    <p><span style="font-weight: bold;">[산책로]</span><br><br>그러나 이상하게 시들시들한 들꽃들도 있다. 누군가가 물을 너무 많이 준 것 같다.</p>
      <button class="nav-button" onclick="goTo('street')">나가기</button>
  </div>
  
      <!-- 산책로-작은 벤치 --> 
    <div id="bench" class="hidden">
    <p><span style="font-weight: bold;">[산책로]<br>[작은 벤치]</span><br><br>바다를 향하는 쪽으로 놓인 벤치. 앉아서 쉬기에 딱 좋은 장소다.<br>
    수평선 끝까지 음산한 청색이 뻗어나간다. 시야를 가리는 것은 아무것도 없다는 사실이 막막하게 느껴진다.<br>
    이렇게 육지와 동떨어진 곳에 있으니, 구조 요청 따위 할 수 있을 리 없다...</p>
    <button onclick="goTo('evi12')">벤치 정면</button>
    <button onclick="goTo('evi15')">벤치 등받이</button><br>
    <button class="nav-button" onclick="goTo('street')">나가기</button>
  </div>

        <!-- 산책로-작은 벤치 --> 
    <div id="evi12" class="hidden">
    <p><span style="font-weight: bold;">[산책로]<br>[작은 벤치]/[정면]</span><br><br>잠시 앉아 있으니 옷이 눅눅해진 느낌이 든다. 최근에 물을 뿌리기라도 한 듯 의자에 물기가 남아 있다.</p>
    <button class="nav-button" onclick="goTo('bench')">나가기</button>
  </div>

          <!-- 산책로-작은 벤치 --> 
    <div id="evi15" class="hidden">
    <p><span style="font-weight: bold;">[산책로]<br>[작은 벤치]/[등받이]</span><br><br>벤치 등받이 뒤쪽 눈에 띄지 않는 위치에 지워지다 만 핏자국이 남아 있다.</p>
    <button class="nav-button" onclick="goTo('bench')">나가기</button>
  </div>
  
      <!-- 산책로2:자전거 대여소 --> 
    <div id="street2" class="hidden">
    <p><span style="font-weight: bold;">[산책로]<br>[자전거 대여소]</span><br><br>1일 1회, 자전거를 대여할 수 있는 대여소.</p>
  <button onclick="goTo('evi11')">자전거를 살펴본다</button><br>
    <button class="nav-button" onclick="goTo('street')">나가기</button>
  </div>

        <!-- 산책로2:자전거 대여소 --> 
    <div id="evi11" class="hidden">
    <p><span style="font-weight: bold;">[산책로]<br>[자전거 대여소]</span><br><br>자전거 중에는 앞에 짐이나 아이를 태울 수 있게끔 작은 수레가 달린 형태도 있다.<br>자세히 보면 수레 안쪽에 약간의 물이 고여 있는 데다가, 익숙한 갈색 머리카락이 한두 가닥이 붙어 있다.<br>아마도 에르네스토의 것이지만... 에르네스토 본인이 직접 작은 수레에 탈 일은 없었겠지.</p>
    <button class="nav-button" onclick="goTo('street')">나가기</button>
  </div>
  
  
  <!-- 산책로:2-2 소원의 호수 입구 --> 
  <div id="street2-2" class="hidden"> 
  <p><span style="font-weight: bold;">[산책로]</span><br><br>어느새 산책로의 끝이다. 눈앞에 보이는 것은 작은 호수다.<br>이런 상황에서 소원이 무슨 의미일지는 모르겠지만...<br><br>호수 근처에 작은 <span style="color: #202e70;">메모장 </span>하나가 떨어져 있다.</p>
  <button onclick="goTo('evi9')">메모장을 확인한다</button><br>
  <button class="nav-button" onclick="goTo('street')">이만 돌아간다</button>
  </div>

    <!-- 산책로:2-2 소원의 호수 입구 --> 
  <div id="evi9" class="hidden"> 
  <p><span style="font-weight: bold;">[산책로]</span><br><br>객실에 비치된 것과 동일한 종류의 메모장이다.<br>안에 적힌 내용은 섬의 토양을 분석한 내용이다. 글씨가 무척 지저분하다.</p>
  <button id="e9" onclick="ev10('e9')">메모장의 내용에 대해 생각해 본다</button><br>
  <button class="nav-button" onclick="goTo('street2-2')">나가기</button>
  <p id="evi10-result"></p>
  </div>

    <!-- 산책로:2-2 소원의 호수 입구 --> 
  <div id="evi10" class="hidden"> 
  <p><span style="font-weight: bold;">[산책로]</span><br><br>어떻게든 읽어 보면, 마땅한 연구 시설도 없는 것치고 상당히 전문적이라는 인상이다.<br>아마 지질학 전공인 에르네스토가 작성한 게 아닐까 하는 생각이 든다.<br>시간대별로 무언가의 수치가 측정된 걸 보면 꽤 자주 산책로에 나온 것 같다.<br><br>
누군가 이 사실을 알았다면 쉽게 노릴 수도 있었을 것이다.</p>
  <button class="nav-button" onclick="goTo('street2-2')">나가기</button>
  </div>
  
<!-- !!!!여기서부터 스크립트!!!! -->
  <script>
  // 애니메이션이 끝난 뒤 hover 작동 허용
  document.querySelectorAll('.menu-button').forEach(button => {
    button.addEventListener('animationend', () => {
      button.style.pointerEvents = 'auto';
    });
  });
//★★★★★[중요]유저 데이터★★★★★
    const userData = {
      mung0515: {
        class: "피자마스터 으믕",
        id: "ThePizzaMaster",
        STR: 6,
        INT: 6,
        OBS: 6,
        POW: 6,
        LUC: 6,
        key: 0,
        coin: 0
      },
      sese0409: {
        class: "감자마스터 세세",
        id: "Linguistics",
        STR: 1,
        INT: 1,
        OBS: 1,
        POW: 1,
        LUC: 1,
        key: 0,
        coin: 0
      },
        erne0409: {
        class: "재해과학자 에르네스토 프로켈",
        id: "NoClassToday",
        STR: 3,
        INT: 3,
        OBS: 3,
        POW: 3,
        LUC: 3,
        key: 0,
        coin: 0
      },
        liva3561: {
        class: "??? ?",
        id: "Untitled",
        STR: 3,
        INT: 3,
        OBS: 3,
        POW: 3,
        LUC: 3,
        key: 0,
        coin: 0}
      ,
              taei0515: {
        class: "퇴마사 태이",
        id: "Taei",
        STR: 5,
        INT: 1,
        OBS: 1,
        POW: 3,
        LUC: 5,
        key: 0,
        coin: 0}
      ,
        pola2469: {
        class: "프론트맨 폴라리스 래피드",
        id: "polaris",
        STR: 5,
        INT: 4,
        OBS: 4,
        POW: 1,
        LUC: 5,
        key: 0,
        coin: 0}
      ,
        siny1538: {
        class: "약사 요시다 신",
        id: "SIN",
        STR: 2,
        INT: 5,
        OBS: 3,
        POW: 4,
        LUC: 2,
        key: 0,
        coin: 0}
      ,
        edit9947: {
        class: "과학수사관 에디트 발랑틴",
        id: "edit",
        STR: 4,
        INT: 4,
        OBS: 4,
        POW: 4,
        LUC: 4,
        key: 0,
        coin: 0}
      ,
        maur3085: {
        class: "소매치기 모리스 레비",
        id: "Levi",
        STR: 3,
        INT: 2,
        OBS: 4,
        POW: 2,
        LUC: 4,
        key: 0,
        coin: 0}
      ,
        jaha4287: {
        class: "스포츠 트레이너 원자한",
        id: "Jahan",
        STR: 4,
        INT: 4,
        OBS: 6,
        POW: 3,
        LUC: 2,
        key: 0,
        coin: 0}
      ,
        wied6391: {
        class: "필체감정사 비더 바이나흐텐",
        id: "WEIHNACHT",
        STR: 1,
        INT: 4,
        OBS: 6,
        POW: 1,
        LUC: 2,
        key: 0,
        coin: 0}
      ,
        isad2597: {
        class: "행정가 이사도르 도슨",
        id: "FT06_dawson",
        STR: 3,
        INT: 4,
        OBS: 5,
        POW: 6,
        LUC: 3,
        key: 0,
        coin: 0}
      ,
        zede0753: {
        class: "생존전문가 제더카이어 어비스",
        id: "AtoZ",
        STR: 5,
        INT: 3,
        OBS: 5,
        POW: 5,
        LUC: 3,
        key: 0,
        coin: 0}
      ,
        akir2740: {
        class: "화가 에이즈카 아키라",
        id: "akila",
        STR: 1,
        INT: 5,
        OBS: 5,
        POW: 5,
        LUC: 4,
        key: 0,
        coin: 0},
              rust8164: {
        class: "우체부 루스티카 테일윈드",
        id: "RUSTIC4",
        STR: 4,
        INT: 1,
        OBS: 4,
        POW: 3,
        LUC: 5,
        key: 0,
        coin: 0},
              seto2566: {
        class: "피아니스트 세토 아이비",
        id: "IVY",
        STR: 3,
        INT: 4,
        OBS: 5,
        POW: 3,
        LUC: 2,
        key: 0,
        coin: 0},
              kuki4917: {
        class: "해커 쿠루미 J. 쿠로키",
        id: "MACHO_KUKI",
        STR: 3,
        INT: 5,
        OBS: 4,
        POW: 3,
        LUC: 1,
        key: 0,
        coin: 0},
              nuri2925: {
        class: "체스마스터 하누리",
        id: "nuriNOW",
        STR: 1,
        INT: 4,
        OBS: 3,
        POW: 5,
        LUC: 4,
        key: 0,
        coin: 0},
              rose1928: {
        class: "수영선수 미아 콜린스",
        id: "RosePinkDolphin",
        STR: 4,
        INT: 2,
        OBS: 5,
        POW: 4,
        LUC: 3,
        key: 0,
        coin: 0},
              ivan2992: {
        class: "수의사 이반 카르포프",
        id: "ivan",
        STR: 4,
        INT: 5,
        OBS: 5,
        POW: 3,
        LUC: 2,
        key: 0,
        coin: 0},
              bury5792: {
        class: "고고학자 베리",
        id: "Berry",
        STR: 5,
        INT: 5,
        OBS: 5,
        POW: 5,
        LUC: 5,
        key: 0,
        coin: 0},
                 fome0838: {
        class: "탐험가 포멜하우트 에빌라",
        id: "Explorer",
        STR: 5,
        INT: 3,
        OBS: 3,
        POW: 5,
        LUC: 2,
        key: 0,
        coin: 0} 
    };

    let currentUser = null;
    let pageHistory = [];
    const outputIds = ['gym-result', 'library-result'];
    
//★★★★★로그인★★★★★
    function checkLogin() {
      const id = document.getElementById('id-input').value;
      if (userData[id]) {
        currentUser = userData[id];
        showWelcomeMessage(currentUser.class);
      } else {
        document.getElementById('login-error').innerText = "아이디가 일치하지 않습니다.";
      }
    }
  
//★★★★★환영 메시지★★★★★
    function showWelcomeMessage(userClass) {
      document.getElementById('login-page').classList.add('hidden');
      const container = document.createElement('div');
      container.classList.add('typewriter');
      container.innerHTML = `초세계급 ${userClass} 님을 환영합니다. . .`;
      document.body.appendChild(container);
      setTimeout(() => {
        container.remove();
        showUserInfo();
        document.getElementById('main-page').classList.remove('hidden');
        pageHistory.push('main-page');
      }, 3600);
    }
//★★★★★유저 인포메이션 창★★★★★
    function showUserInfo() {
      const userBox = document.getElementById('user-display');
      document.getElementById('user-class-line').innerHTML = `User ID: ${currentUser.id}`;
      userBox.classList.remove('hidden');
    }

//★★★★★출력된 텍스트 아웃풋 창 넘어갈 때 지우기 (goTo 연동용)★★★★★
    function clearOutputs() {
  outputIds.forEach(id => {
    const el = document.getElementById(id);
    if (el) el.innerText = '';
  });

  // 모든 *-result 요소도 비우기
  document.querySelectorAll('[id$="-result"]').forEach(el => {
    el.innerText = '';
  });
}


//★★★★★goTo★★★★★
function goTo(page) {
  // 창 이동시 숨겨지지 않는 디스플레이 설정
  const exceptions = ['user-display','persistent-nav','bgm-player','bgm-player button'];  
  document.querySelectorAll('div').forEach(div => {
    const isException = exceptions.includes(div.id) || div.closest('#user-display') || div.closest('#persistent-nav');
    if (!isException) {
      div.classList.add('hidden');
    }
  });
  //지우고 페이드 인
  const target = document.getElementById(page);
  target.classList.remove('hidden');
  target.classList.add('fade-in');
  if (page === 'suite1') {
    const btn = document.getElementById('secret-code-button');
    if (btn) btn.classList.remove('hidden');
  }
  clearOutputs();
  pageHistory.push(page);
  //[중요]특정 페이지 진입 시 증거 획득
    if (['evi1'].includes(page)) {
    currentUser.evid1 = true;
  }
    if (['evi2'].includes(page)) {
    currentUser.evid2 = true;
  }
    if (['evi3'].includes(page)) {
    currentUser.evid3 = true;
  }
    if (['evi4'].includes(page)) {
    currentUser.evid4 = true;
  }
    if (['evi5'].includes(page)) {
    currentUser.evid5 = true;
  }
    if (['evi6'].includes(page)) {
    currentUser.evid6 = true;
  }
    if (['evi7'].includes(page)) {
    currentUser.evid1 = true;
  }
    if (['evi8'].includes(page)) {
    currentUser.evid8 = true;
  }
    if (['evi9'].includes(page)) {
    currentUser.evid9 = true;
  }
    if (['evi10'].includes(page)) {
    currentUser.evid10 = true;
  }
    if (['evi11'].includes(page)) {
    currentUser.evid11 = true;
  }
    if (['evi12'].includes(page)) {
    currentUser.evid12 = true;
  }
    if (['evi13'].includes(page)) {
    currentUser.evid13 = true;
  }
    if (['nfl'].includes(page)) {
    currentUser.evidnfl = true;
  }
      if (['evi14'].includes(page)) {
    currentUser.evid14 = true;
  }
      if (['evi15'].includes(page)) {
    currentUser.evid15 = true;
  }
    if (page === 'starting-point') {
    document.getElementById('persistent-nav').style.display = 'flex';
  }}

//★★★★★goTodel(이동과 동시에 버튼 삭제)★★★★★   
function goTodel(targetPage, buttonId) {
  const btn = document.getElementById(buttonId);
  if (btn) btn.remove(); // 한 번만 지움
  goTo(targetPage); // 기존 페이지 이동 로직 재사용
}

//★★★★★goToWithSound(페이지 이동 버튼 누를 때 효과음(일시) 재생)★★★★★   
  function goToWithSound(page, soundFile) {
      const audio = new Audio(soundFile);
      audio.loop = false;
      audio.volume = 0.3;
      audio.play();
      goTo(page);
    }

//★★★★★goToWithSound(페이지 이동 버튼 누를 때 효과음 계속해서 재생, 루프)★★★★★  
let zzapseaAudio = null;
let zzapportAudio = null;

function goToWithSoundNL(page, soundFile) {
  if (soundFile.includes('zzapsea.mp3')) {
    zzapseaAudio = new Audio(soundFile);
    zzapseaAudio.loop = true;
    zzapseaAudio.play();
  } else if (soundFile.includes('zzapport.mp3')) {
    zzapportAudio = new Audio(soundFile);
    zzapportAudio.loop = true;
    zzapportAudio.play();
  } else {
    const audio = new Audio(soundFile);
    audio.loop = true;
    audio.play();
  }
  goTo(page);
}

//★★★★★해당 버튼을 누를 시, 페이지 이동과 동시에 zzapseaAudio 중지★★★★★
function goToWithoutzzapsea(page) {
  if (zzapseaAudio && !zzapseaAudio.paused) {
    zzapseaAudio.pause();
    zzapseaAudio.currentTime = 0;
  }
  if (zzapportAudio && !zzapportAudio.paused) {
    zzapportAudio.pause();
    zzapportAudio.currentTime = 0;
  }
  goTo(page);
}

//★★★★★goBack★★★★★  
function goBack() {
  if (pageHistory.length > 1) {
    // 현재 페이지 제거
    pageHistory.pop();
    const prevPage = pageHistory[pageHistory.length - 1];

    // 예외 요소들 (루트 + 내부 포함 전부 보호)
    const persistentRoots = ['user-display', 'bgm-player', 'persistent-nav'];

    // 모든 div를 숨기되, 예외 요소 또는 그 자식은 숨기지 않음
    document.querySelectorAll('div').forEach(div => {
      const isPersistent = persistentRoots.some(rootId => {
        const rootEl = document.getElementById(rootId);
        return rootEl && (div === rootEl || rootEl.contains(div));
      });
      if (!isPersistent) {
        div.classList.add('hidden');
      }
    });

    // 이전 페이지 보여주기
    const target = document.getElementById(prevPage);
    if (target) {
      target.classList.remove('hidden');
      target.classList.add('fade-in');
    }

    // 텍스트 강제 갱신 (혹시라도 브라우저 캐시가 날려버린 경우)
    if (currentUser) {
      const idLine = document.getElementById('user-class-line');
      if (idLine) idLine.innerText = `User ID: ${currentUser.id}`;
      if (coinLine) coinLine.innerText = `Coin: ${currentUser.coin || 0}`;
    }

    // 출력 영역 초기화
    clearOutputs();
  }
}




//여기서부터 특정 장소에서 사용하도록 되어 있는 함수!!!!
function ev2(buttonId) {
  if (currentUser.STR >= 4) {
    goTo('evi2');
  } else {
    const result = document.getElementById('evi2-result');
    result.innerText = "자세히 살펴봤지만 더 떠오르는 것은 없다.";
  }
}

function ev4(buttonId) {
  if (currentUser.POW >= 4) {
    goTo('evi4');
  } else {
    const result = document.getElementById('evi4-result');
    result.innerText = "자세히 보기에는 지나치게 참혹한 모습이다.";
  }
}

function ev6(buttonId) {
  if (currentUser.OBS >= 4) {
    goTo('evi6');
  } else {
    const result = document.getElementById('evi6-result');
    result.innerText = "자세히 살펴봤지만 눈에 띄는 것은 없다.";
  }
}

function ev8(buttonId) {
  if (currentUser.LUC >= 3) {
    goTo('evi8');
  } else {
    const result = document.getElementById('evi8-result');
    result.innerText = "눈에 띄는 것은 없다.";
  }
}
function ev10(buttonId) {
  if (currentUser.INT >= 4) {
    goTo('evi10');
  } else {
    const result = document.getElementById('evi10-result');
    result.innerText = "자세히 들여다보았지만 더 생각나는 것은 없다.";
  }
}

//★★★★★퀴즈★★★★★
function checkSecretCode() {
  const input = document.getElementById('secret-code-input').value;
  if (input === "에르네스토 프로켈") { // 원하는 정답
    const codebox = document.getElementById('codebox');
    goTo('evi13');
  } else {
    const result = document.getElementById('secret-code-result');
    result.innerText = "잠겨 있는 방이다.";
  }
}    

//파이널 리포트 걍 여기다 두려고... 
function loadFinalReport() {
  document.body.innerHTML = '';

  const div = document.createElement('div');
  div.id = 'final-report';
  div.className = 'fade-in';
  div.style = `
    max-width: 700px;
    margin: 100px auto;
    background: white;
    border: 3px solid #202e70;
    border-radius: 10px;
    color: black;
    padding: 2em;
    font-family: 'Noto Sans KR', sans-serif;
    position: relative;
  `;

  const lines = [
    { html: `<em style="color: #202e70;">초세계급 ${currentUser.class} 님이 조사를 완료하였습니다…</em>`, align: 'left', lineStyle: 'color: #202e70; font-style: italic;' },
    { html: `<em style="color: #202e70;">조사 결과 저장 중…</em>`, align: 'left', lineStyle: 'color: #202e70; font-style: italic;' },
    { html: `<span style="color: black;">User ID : ${currentUser.id} | STR ${currentUser.STR}  INT ${currentUser.INT}  OBS ${currentUser.OBS}  POW ${currentUser.POW}  LUC ${currentUser.LUC}</span>`, align: 'left', lineStyle: 'color: black;' },
  ];


  if (currentUser.evid1 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">잘 정돈된 시체의 상태</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
  if (currentUser.evid2 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">시체를 묻기 위해서는 상당한 힘이 필요했을 것으로 추정</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
  if (currentUser.evid3 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">후두부를 가격당한 흔적</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
  if (currentUser.evid4 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">흉기는 타격 범위가 넓은 둔기로 추정</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
  if (currentUser.evid5 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">시체에 헌화한 듯한 흔적</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
    if (currentUser.evid6 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">신발에 묻은 잡초</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
  if (currentUser.evidnfl === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">사라진 헌화용 국화</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
  if (currentUser.evid7 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">무덤을 만들고 관리하는 도구에는 사용 흔적이 없으나, 고무호스나 물 양동이 등을 사용한 흔적</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
  if (currentUser.evid8 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">산책로의 시들시들한 들꽃들</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
  if (currentUser.evid9 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">호수 근처의 메모장</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
  if (currentUser.evid10 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">에르네스토는 평소에도 산책로에 자주 왔던 것으로 추정</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
  if (currentUser.evid11 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">자전거 수레에서 발견된 에르네스토의 머리카락</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
  if (currentUser.evid12 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">산책로의 작은 벤치에 남은 물기</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
    if (currentUser.evid13 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">에르네스토의 개인실에 메모장이 없었던 것</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
  if (currentUser.evid14 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">건드린 흔적이 없는 도구함</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
    if (currentUser.evid15 === true) {
    lines.push({ html: `<div style="color: black; font-style: italic;">산책로의 작은 벤치에 남은 지워지다 만 핏자국</div>`, align: 'right', lineStyle: 'color: black; font-style: italic;' });
  }
  lines.push({ html: `<div style="color: #888">별도의 제출은 필요로 하지 않습니다.</div>`, align: 'right', lineStyle: 'color: #888;' });

  const content = document.createElement('div');
  div.appendChild(content);
  document.body.appendChild(div);

  lines.forEach(({ html, align, lineStyle }) => {
    const container = document.createElement('div');
    container.style = `position: relative; margin-bottom: 1.5em; min-height: 1.5em; text-align: ${align};`;

    const real = document.createElement('div');
    real.className = 'typed-line';
    real.style = `text-align: ${align}; ${lineStyle}`;
    real.innerHTML = html;

    container.appendChild(real);
    content.appendChild(container);
  });
}

const style = document.createElement('style');
style.innerHTML = `
  .typed-line {
    position: relative;
    z-index: 1;
    white-space: pre-wrap;
    animation: slideIn 0.6s ease-out both;
  }
  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateX(-30px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }
`;
document.head.appendChild(style);

  </script>
</body>
</html>
